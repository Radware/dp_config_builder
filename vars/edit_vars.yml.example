---
# edit_vars.yml.example - Template for editing profiles variables
# Copy this file to edit_vars.yml and customize with your environment details

# Target DefensePro devices - add or remove IP addresses as needed
dp_ip:
  - "10.105.192.32"
  # - "10.105.192.33"
  # - "10.105.192.34"

# Define the network class groups to edit
# Each entry specifies which class_name, index, and new values to apply
# To get the current network class structure and indices, use the get_network_class module first
edit_networks:
  # Example: Edit index 2 of "egor_test_net" to have address 100.1.117.0/27
  - {class_name: "egor_test_net", index: 2, address: "100.1.117.0", mask: "27"}
  
  # Example: Edit index 1 of "egor_test_net" to have address 100.16.10.0/24  
  - {class_name: "egor_test_net", index: 1, address: "100.16.10.0", mask: "24"}
  
  # Example: Edit index 0 with subnet mask in dotted decimal notation
  # - {class_name: "egor_test_net", index: 0, address: "192.168.100.0", mask: "255.255.255.0"}
  
  # Example: Edit different network class
  # - {class_name: "another_net_class", index: 0, address: "10.0.0.0", mask: "255.255.255.0"}
  
  # Add more entries as needed - the playbook will process all combinations of dp_ip Ã— edit_networks

# Notes for Network Classes:
# - class_name: Must be an existing network class name
# - index: The sub-index of the network group within the class (starting from 0)
# - address: The new network address to assign
# - mask: Can be CIDR notation (e.g., "24") or dotted decimal (e.g., "255.255.255.0")
# - Use get_network_class module to discover existing classes and their current indices

################################## Connection Limit Protections Variables ###############################
# Define connection limit protections to edit
# Each protection requires protection_index (mandatory) to identify which protection to edit
# Protection_index can be found either by checking on DefensePro UI Protections-> Connection Limit protections menu or by running get_cl_protections.yml playbook
# Only specify parameters you want to change - unspecified parameters remain unchanged
edit_cl_protections:
  # Example: Edit protection index 450001, changing multiple parameters
  - protection_index: 450001               # Protection index to edit (MANDATORY - starts from 450001)
    protection_name: "HTTP Protection"      # Descriptive name for documentation (optional)
    protocol: "tcp"                        # Protocol: tcp, udp (optional - only if changing)
    threshold: "500"                       # Connection rate threshold as string (optional - only if changing)
    app_port_group: "http"                 # Application port group - lowercase (optional - only if changing)
    tracking_type: "src_ip"                # Tracking: src_ip, dst_ip, src_and_dest_ip, dst_ip_and_port (optional)
    action: "drop"                         # Action: drop, report_only (optional - only if changing)
    packet_report: "enable"                # Packet reporting: enable, disable (optional - only if changing)
    protection_type: "cps"                 # Protection type: cps, concurrent_connections (optional - only if changing)

  # Example: Edit protection index 450003, changing only specific parameters
  # - protection_index: 450003             # Another protection to edit
  #   protection_name: "SMTP Protection"    # Descriptive name
  #   protocol: "tcp"                      # Protocol type
  #   threshold: "200"                     # Connection limit threshold
  #   app_port_group: "smtp"               # Application port group (or leave empty "" for all ports)
  #   tracking_type: "dst_ip"              # Tracking type
  #   action: "report_only"                # Action mode
  #   packet_report: "disable"             # Packet reporting setting
  #   protection_type: "concurrent_connections" # Protection detection type

  # Example: Edit protection index 450005, changing minimal parameters
  # - protection_index: 450005             # Yet another protection
  #   threshold: "1000"                    # Only change the threshold
  #   action: "drop"                       # Only change the action
  #   # All other parameters remain unchanged

  # Add more protection entries as needed

# Notes for Connection Limit Protections:
# - protection_index: MANDATORY - identifies which protection to edit (get from DefensePro UI or future get_cl_protections.yml)
#   Connection limit protection indexes start from 450001 and increment upward
# - protection_name: Optional descriptive label for documentation
# - Only specify parameters you want to change - unspecified parameters keep their current values
# 
# ALL SUPPORTED Connection Limit Protections PARAMETERS with user-friendly values:
# - protocol: "tcp", "udp" (Protocol type)
# - threshold: "number" (Connection limit threshold as string, e.g., "500", "1000")
# - app_port_group: "http", "https", "smtp", "dns", "ftp", "imap" or custom port, "" for all ports (must be lowercase)
# - tracking_type: "src_ip", "dst_ip", "src_and_dest_ip", "dst_ip_and_port" (What to track for limiting)
# - action: "drop", "report_only" (Action when threshold exceeded)
# - packet_report: "enable", "disable" (Detailed packet reporting)
# - protection_type: "cps", "concurrent_connections" (Detection type: Connections Per Second vs Total Active Connections)

########################## Edit BDoS Profile ##########################
# Define BDOS profiles to create on each device
bdos_profiles:
  - name: "BDOS_Profile_5"
    params:
      action: "report_only"                  # report_only/block_and_report
      syn_flood: "enable"                    # enable/disable
      udp_flood: "enable"                    # enable/disable
      igmp_flood: "enable"                 # enable/disable
      icmp_flood: "enable"                   # enable/disable
      tcp_ack_fin_flood: "enable"          # enable/disable
      tcp_rst_flood: "enable"              # enable/disable
      tcp_syn_ack_flood: "enable"          # enable/disable
      tcp_frag_flood: "enable"             # enable/disable
      udp_frag_flood: "enable"             # enable/disable
      inbound_traffic: 1000000               # 1 to 1342177280
      outbound_traffic: 500000               # 1 to 1342177280
      tcp_in_quota: 80                        # 0-100
      udp_in_quota: 50
      icmp_in_quota: 10
      igmp_in_quota: 50
      tcp_out_quota: 80
      udp_out_quota: 50
      icmp_out_quota: 10
      igmp_out_quota: 50
      transparent_optimization: "enable"        # enable/disable
      packet_report: "enable"                # enable/disable
      burst_attack: "disable"                # enable/disable
      maximum_interval_between_bursts: 60    # minutes
      learning_suppression_threshold: 10     # 0-50
      footprint_strictness: "medium"         # low/medium/high
      bdos_rate_limit: "user_defined"        # disable/normal_edge/suspect_edge/user_defined
      user_defined_rate_limit: 500           # 0-4000
      user_defined_rate_limit_unit: "mbps"   # kbps/mbps/gbps
      adv_udp_detection: "enable"            # enable/disable

################################### Edit Security Policies #############################
# Define security policies to edit (must exist on the DefensePro)
# Each policy requires policy_name (mandatory) to identify which policy to edit
# Only specify parameters you want to change - unspecified parameters remain unchanged
edit_security_policies:
  - policy_name: "egor_security_policy_demo"  # Policy name to edit (MANDATORY)
    # Basic configuration parameters (all optional)
    # src_network: "any"                     # Source network class name or "any"
    # dst_network: "egor_test_net"           # Destination network class name or "any"
    direction: "oneway"                    # oneway, twoway, bidirectional
    state: "disable"                        # enable, disable, active, inactive
    action: "report_only"                        # block_and_report, report_only
    # priority: "860"                        # Priority value (1-1000)
    # packet_reporting_status: "enable"      # enable, disable
    
    # Profile bindings (all optional - use empty string to remove binding)
    connection_limit_profile: "cl_prof_egor_test10"   # Connection limit profile name
    # bdos_profile: ""                                  # BDOS profile name
    # syn_protection_profile: ""                        # SYN protection profile name
    # dns_flood_profile: ""                             # DNS flood profile name
    # https_flood_profile: ""                           # HTTPS flood profile name
    # traffic_filters_profile: ""                       # Traffic filters profile name
    # signature_protection_profile: ""                  # Application security profile name
    # ert_attackers_feed_profile: ""                    # ERT attackers feed profile name
    # geo_feed_profile: ""                              # Geo feed profile name
    # out_of_state_profile: ""                          # Out of state profile name

  # Example: Edit another policy with different parameters
  # - policy_name: "another_security_policy"
  #   state: "disable"                       # Disable the policy
  #   action: "report_only"                  # Change to report only mode
  #   connection_limit_profile: ""           # Remove connection limit profile binding